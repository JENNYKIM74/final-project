<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hta.lecture.mapper.ClassMapper">

	<select id="getAllClasses" resultType="com.hta.lecture.vo.Classes">
		select
			class_no				as no,
			class_title				as title,
			class_content			as content,
			class_difficultly		as difficultly,
			class_image				as image,
			class_video				as video,
			class_income			as income,
			class_period			as period,
			class_price				as price,
			class_discountprice		as discountPrice,
			class_permission		as permission,
			class_filter			as filter,
			class_status			as status,
			class_application_date	as applicationDate,
			class_open_date			as openDate,
			class_updated_date		as updatedDate,
			class_deleted_date		as deletedDate,
			class_total_count		as totalCount,
			class_total_time		as totalTime,
			class_isdeleted			as isDeleted,
			teacher_no				as teacherNo,
			category_no				as categoryNo
		from
			final_class_tb
		order by
			class_no desc
	</select>
	
	<select id="getAllCourseInfo" resultType="com.hta.lecture.dto.ClassCourseDto">
		select
			C.class_no 					as no,
			C.class_title 				as title,
			T.teacher_name				as name,
			C.class_price 				as price,
			C.class_discountprice 		as discountPrice,
			C.class_image 				as image,
			S.cnt 						as studentCount
		from
			final_class_tb C, final_teacher_tb T, (select class_no, count(*) cnt
													from final_progress_tb
													group by class_no) S
		where
			C.teacher_no = T.teacher_no and C.class_no = S.class_no
	</select>
	
	<select id="countAllClassStudent" parameterType="int" resultType="int">
		select
			count(*)
		from
			final_progress_tb P, final_class_tb C
		where
			P.class_no = C.class_no and C.class_no = #{value}
	</select>
	<select id="">
		select
		    R.review_grade * G.cnt
		from final_review_tb R, final_class_tb C, (select count(*) cnt
		                                            from final_review_tb
		                                            where review_grade = 5) G
		where R.class_no = C.class_no and review_grade = 5 and rownum = 1;
	</select>
</mapper>